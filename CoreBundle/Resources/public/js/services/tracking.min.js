!function(e,t){"function"==typeof define&&define.amd?define(["stratus","underscore"],t):t(e.Stratus,e._)}(this,function(e,t){e.Services.Tracking=["$provide",function(e){e.factory("tracking",["$document","$window",function(e,t){return function(){this.parseURL=function(e){var t=document.createElement("a");return t.href=e,t.hostname},this.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},this.getUTMCode=function(e){var t=this.getParameterByName(e);return t||"utmSource"!=e||(t=this.parseURL(document.referrer)),t},this.getRefcode=function(){var e=this.getUTMCode("utmCampaign"),t=this.getUTMCode("utmSource"),n=this.getUTMCode("utmMedium");return(e?e+"/":"")+(t?t:"")+(n?"/"+n:"")},this.setRefcode=function(e){e=e?e:{},e.url=e.url?e.url:"https://secure.actblue.com";var t=document.querySelectorAll('[href^="'+e.url+'"]');if(t.length>0)for(var n=this.getRefcode(),r=0;r<t.length;r++){var o=t[r];o.href=o.href+"?refcode="+n}},this.send=function(e,t){return"function"==typeof ga&&(ga("send","event",e,t),!0)}}}])}]});