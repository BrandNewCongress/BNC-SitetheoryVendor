!function(e,t){"function"==typeof define&&define.amd?define(["stratus","underscore"],t):t(e.Stratus,e._)}(this,function(e,t){e.Services.Tracking=["$provide",function(t){t.factory("tracking",["$document","$window",function(t,n){return function(){this.parseURL=function(e){var t=document.createElement("a");return t.href=e,t.hostname},this.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},this.getUTMCode=function(e){var t=this.getParameterByName(e);return t||"utmSource"!=e||(t=this.parseURL(document.referrer)),t},this.getRefcode=function(){var e=this.getUTMCode("utmCampaign"),t=this.getUTMCode("utmSource"),n=this.getUTMCode("utmMedium");return(e?e+"/":"")+(t?t:"")+(n?"/"+n:"")},this.setRefcode=function(t){t=t?t:{},t.url=t.url?t.url:"http";var n=document.querySelectorAll('[href^="'+t.url+'"]');if(n.length>0)for(var r=this.getRefcode(),o=0;o<n.length;o++){var i=n[o];i.href=e.Internals.SetUrlParams({refcode:r},i.href)}},this.send=function(e,t){return"function"==typeof ga&&(ga("send","event",e,t),!0)}}}])}]});