!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Services.Tracking=["$provide",function($provide){$provide.factory("Tracking",["$document","$window",function($document,$window){return function(){this.parseURL=function(url){var a=document.createElement("a");return a.href=url,a.hostname},this.getParameterByName=function(name,url){url||(url=window.location.href),name=name.replace(/[[\]]/g,"\\$&");var results=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},this.getUTMCode=function(name){const value=this.getParameterByName(name);return value||"utmSource"!==name?value:this.parseURL(document.referrer)},this.getRefcode=function(){var recruiterCode=window.location.href.match(/(?:\?|&)ref=([a-zA-Z0-9]+)/);if(recruiterCode)return recruiterCode[1];var utmCampaign=this.getUTMCode("utmCampaign"),utmSource=this.getUTMCode("utmSource"),utmMedium=this.getUTMCode("utmMedium");return(utmCampaign?utmCampaign+"/":"")+(utmSource||"")+(utmMedium?"/"+utmMedium:"")},this.setRefcode=function(options){(options=options||{}).url=options.url?options.url:"http";var links=document.querySelectorAll('[href^="'+options.url+'"]');if(links.length>0)for(var refCode=this.getRefcode(),index=0;index<links.length;index++){var link=links[index];link.href=Stratus.Internals.SetUrlParams({refcode:refCode},link.href)}},this.send=function(category,action){return"function"==typeof ga&&(ga("send","event",category,action),!0)}}}])}]});