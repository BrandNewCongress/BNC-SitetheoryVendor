!function(e,t){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","angular-material","angular-sanitize","stratus.services.model","stratus.services.tracking"],t):t(e.Stratus,e._)}(this,function(e,t){e.Modules.ngSanitize=!0,e.Controllers.Api=function(o,n,a,s,i,r,l,u){var p=t.uniqueId("api_");e.Instances[p]=o,o.model=new l,o.tracking=new u;window.location.hostname.split(".").reverse();if(e.DOM.ready(function(){o.tracking.setRefcode()}),o.easingFn=function(e,t,o,n){var a=(e/=n)*e,s=a*e;return t+o*(s*a+-5*a*a+10*s+-10*a+5*e)},o.options={id:p,pattern:{email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,zip:/[a-zA-Z0-9 \-]{5,}/,phone:/^[0-9]{10,}$/},url:null,controller:null,response:{invalid:"There was a validation error, please check the fields below.",success:"Thanks for your information! We review every submission and we'll be in touch.",error:"Sorry ;( looks like there was an error saving your info. Please email us directly so we can help."},scrollTo:null,scrollToOffset:0,redirect:{url:!1,config:null},contentType:"json",prototype:{dataType:"json",method:"GET",url:"",headers:{},data:""},onLoad:null,onTime:null,reset:{},dynamicOptions:{}},s.options){var d=r(s.options)(o);t.isJSON(d)&&(o.options=t.extendDeep(o.options,JSON.parse(d)))}o.options.url||console.error("You must provide an API url via the options.url attribute, e.g. https://api.domain.com."),o.options.controller||console.error("You must provide an API controller via the options.controller attribute, e.g. /people."),o.options.url&&(o.options.prototype.url=o.options.url+o.options.controller),o.states=[{value:"AL",text:"Alabama"},{value:"AK",text:"Alaska"},{value:"AZ",text:"Arizona"},{value:"AR",text:"Arkansas"},{value:"CA",text:"California"},{value:"CO",text:"Colorado"},{value:"CT",text:"Connecticut"},{value:"DE",text:"Delaware"},{value:"FL",text:"Florida"},{value:"GA",text:"Georgia"},{value:"HI",text:"Hawaii"},{value:"ID",text:"Idaho"},{value:"IL",text:"Illinois"},{value:"IN",text:"Indiana"},{value:"IA",text:"Iowa"},{value:"KS",text:"Kansas"},{value:"KY",text:"Kentucky"},{value:"LA",text:"Louisiana"},{value:"ME",text:"Maine"},{value:"MD",text:"Maryland"},{value:"MA",text:"Massachusetts"},{value:"MI",text:"Michigan"},{value:"MN",text:"Minnesota"},{value:"MS",text:"Mississippi"},{value:"MO",text:"Missouri"},{value:"MT",text:"Montana"},{value:"NE",text:"Nebraska"},{value:"NV",text:"Nevada"},{value:"NH",text:"New Hampshire"},{value:"NJ",text:"New Jersey"},{value:"NM",text:"New Mexico"},{value:"NY",text:"New York"},{value:"NC",text:"North Carolina"},{value:"ND",text:"North Dakota"},{value:"OH",text:"Ohio"},{value:"OK",text:"Oklahoma"},{value:"OR",text:"Oregon"},{value:"PA",text:"Pennsylvania"},{value:"RI",text:"Rhode Island"},{value:"SC",text:"South Carolina"},{value:"SD",text:"South Dakota"},{value:"TN",text:"Tennessee"},{value:"TX",text:"Texas"},{value:"UT",text:"Utah"},{value:"VT",text:"Vermont"},{value:"VA",text:"Virginia"},{value:"WA",text:"Washington"},{value:"WV",text:"West Virginia"},{value:"WI",text:"Wisconsin"},{value:"WY",text:"Wyoming"}],o.reset=function(e){o.response="",o.status="default",o.results={},o.options.reset&&o.options.reset instanceof Object?"clear"in o.options.reset&&o.options.reset.clear&&o.options.reset.clear.length>0?t.each(o.options.reset.clear,function(e){e in o.model.data&&(o.model.data[e]=null)}):"keep"in o.options.reset&&o.options.reset.keep&&o.options.reset.keep.length>0?t.each(o.model.data,function(e,n){t.contains(o.options.reset.keep,n)||(o.model.data[n]=null)}):o.model.data={}:o.model.data={},e&&e in o&&(o[e].$setPristine(),o[e].$setUntouched()),o.model.data.utmCampaign=o.tracking.getUTMCode("utmCampaign"),o.model.data.utmSource=o.tracking.getUTMCode("utmSource"),o.model.data.utmMedium=o.tracking.getUTMCode("utmMedium")},o.reset(),o.serialize=function(e){var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")},o.submit=function(e){function t(e){if(e&&200==e.status){if(o.response=o.options.response.success,o.status="success",o.results=e.data,o.options.redirect.url){var t="?refcode="+o.tracking.getRefcode();i.location=o.options.redirect.url+t}}else o.response=o.options.response.error,o.response+=e?" ["+e.code+": "+e.data+"]":" ["+e.status+"]",o.status="error"}function n(e){o.response=o.options.response.error,o.response+=e.code&&e.data?" ["+e.code+": "+e.data+"]":" ["+e+"]",o.status="error"}if(o.status="sending",o.response="",o.options.prototype.url){var s=a(o.options.prototype);return s["catch"]?s.then(t,n)["catch"](n):s.then(t,n),s}},o.fetch=function(){return o.options.prototype.method="GET",o.submit()},o.send=function(e){return o[e].$valid?(o.options.prototype.method="POST",o.options.prototype.dataType=o.options.contentType,"form"==o.options.contentType?(o.options.prototype.headers["Content-Type"]="application/x-www-form-urlencoded",o.options.prototype.data=o.serialize(o.model.data)):(o.options.prototype.headers["Content-Type"]="application/json",o.options.prototype.data=o.model.data),o.submit(e)):(o.response=o.options.response.invalid,o.status="error",!1)},null!==o.options.onLoad&&o.options.onLoad.length>0&&(Array.isArray(o.options.onLoad)?t.each(o.options.onLoad,function(e){t.contains(o,e)&&o[e]()}):o.options.onLoad in o&&o[o.options.onLoad]()),null!==o.options.onTime&&(Array.isArray(o.options.onTime)&&o.options.onTime.length>0?t.each(o.options.onTime,function(t){"object"==typeof t&&t.time&&t.method&&t.method in o&&e.Chronos.add({time:t.time,method:o[t.method],enabled:!0})}):"object"==typeof o.options.onTime&&o.options.onTime.time&&o.options.onTime.method&&o.options.onTime.method in o&&e.Chronos.add({time:o.options.onTime.time,method:o[o.options.onTime.method],enabled:!0}))}});